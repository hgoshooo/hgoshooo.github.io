<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>FFmpeg Browser Scaling</title>
<style>
body { font-family:sans-serif; text-align:center; background:#111; color:#fff; }
input, button { margin:10px; padding:8px; font-size:16px; }
video { margin-top:20px; max-width:90%; border:2px solid #fff; border-radius:10px; display:block; margin:auto; }
</style>
</head>
<body>
<h1>FFmpeg Browser Video Scaler</h1>

<input type="file" id="fileInput" accept="video/mp4">
<button id="processBtn">Scale Video 50%</button>
<video id="videoPlayer" controls></video>
<a id="downloadLink" style="display:block; margin-top:20px; color:#0f0;"></a>

<script src="https://cdn.jsdelivr.net/npm/@ffmpeg/ffmpeg@0.11.8/dist/ffmpeg.min.js"></script>
<script>
const { createFFmpeg, fetchFile } = FFmpeg;
const ffmpeg = createFFmpeg({ log: true });

const fileInput = document.getElementById("fileInput");
const processBtn = document.getElementById("processBtn");
const videoPlayer = document.getElementById("videoPlayer");
const downloadLink = document.getElementById("downloadLink");

processBtn.onclick = async () => {
    if (!fileInput.files.length) return alert("Select a file first!");
    const file = fileInput.files[0];

    if (!ffmpeg.isLoaded()) await ffmpeg.load();

    ffmpeg.FS('writeFile', 'input.mp4', await fetchFile(file));

    // Scale video to 50%
    await ffmpeg.run('-i', 'input.mp4', '-vf', 'scale=iw/2:ih/2', 'output.mp4');

    const data = ffmpeg.FS('readFile', 'output.mp4');
    const url = URL.createObjectURL(new Blob([data.buffer], { type: 'video/mp4' }));

    videoPlayer.src = url;
    videoPlayer.load();
    videoPlayer.play().catch(()=>{});

    downloadLink.href = url;
    downloadLink.download = 'output.mp4';
    downloadLink.textContent = "Download Scaled Video";
};
</script>
</body>
</html>
