<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Video Processor</title>
<style>
body { font-family: sans-serif; text-align: center; background:#111; color:#fff; }
input, button { margin:10px; padding:8px; font-size:16px; }
video { margin-top:20px; max-width:90%; border:2px solid #fff; border-radius:10px; display:block; margin:auto; }
a { display:block; margin-top:10px; color: #0f0; }
</style>
</head>
<body>
<h1>Video Processor</h1>
<p>Select a local MP4 file:</p>
<input type="file" id="fileInput" accept="video/mp4">
<button id="processBtn">Process</button>
<p id="status"></p>
<video id="outputVideo" controls></video>
<a id="downloadLink" href="#" download="output.mp4" style="display:none;">Download Processed Video</a>

<script src="https://cdn.jsdelivr.net/npm/@ffmpeg/ffmpeg@0.12.6/dist/ffmpeg.min.js"></script>
<script>
const { createFFmpeg, fetchFile } = FFmpeg;
const ffmpeg = createFFmpeg({ log: true });
const status = document.getElementById("status");
const output = document.getElementById("outputVideo");
const downloadLink = document.getElementById("downloadLink");

document.getElementById("processBtn").onclick = async () => {
    const fileInput = document.getElementById("fileInput");
    if (fileInput.files.length === 0) {
        status.textContent = "⚠️ Please select a file.";
        return;
    }

    const file = fileInput.files[0];
    status.textContent = "Loading FFmpeg...";
    if (!ffmpeg.isLoaded()) await ffmpeg.load();

    status.textContent = "Processing video...";
    ffmpeg.FS("writeFile", "input.mp4", await fetchFile(file));

    // Apply scale: half the width/height
    await ffmpeg.run("-i","input.mp4","-vf","scale=iw/2:ih/2","-c:v","copy","-c:a","copy","output.mp4");

    const data = ffmpeg.FS("readFile","output.mp4");
    const videoBlob = new Blob([data.buffer], { type: "video/mp4" });
    const videoURL = URL.createObjectURL(videoBlob);

    output.src = videoURL;
    downloadLink.href = videoURL;
    downloadLink.style.display = "block";

    status.textContent = "✅ Done! Play below or download.";
};
</script>
</body>
</html>
